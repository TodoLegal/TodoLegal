<%# 
  Loading state indicator for progressive chunk loading
  Shows loading spinner and manages "load more" state
  Compatible with law-infinite-scroll Stimulus controller
%>
<div id="loading-indicator" class="loading-container">
  <% if has_more %>
    <div class="loading-trigger" 
         data-law-infinite-scroll-target="loading"
         data-current-page="<%= current_page %>"
         data-law-id="<%= law.id %>"
         data-has-more="<%= has_more %>"
         style="min-height: 60px;">
      
      <div class="d-flex flex-column justify-content-center align-items-center p-4">
        <div class="law-loading-spinner" style="display: none;">
          <div class="container-loader"> 
            <div class="loader"></div>
            <span class="sr-only">Loading...</span>
          </div>
        </div>
        
        <div class="loading-text">
          <span class="load-more-text">Cargando más artículos...</span>
        </div>
      </div>
      
      <!-- Manual load more button (fallback for non-intersection observer) -->
      <div class="text-center mt-2">
        <button class="btn btn-outline-primary btn-sm load-more-btn" 
                data-action="click->law-infinite-scroll#loadNextChunk"
                style="display: none;">
          <i class="fas fa-plus me-1"></i>
          Cargar más artículos
        </button>
      </div>
    </div>
  <% else %>
    <div class="end-of-content text-center p-4">
      <div class="text-muted">
        <i class="fas fa-check-circle me-2"></i>
        <span>Has llegado al final del documento</span>
      </div>
    </div>
  <% end %>
</div>