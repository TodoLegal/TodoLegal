<div class="container">
  <p> </p>
  <h1>
    <%= link_to '<i class="fas fa-arrow-left"></i>'.html_safe, law_path%>
    Edición archivo Legal
  </h1>

  <script>
    $(document).ready(function(){
      $('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
        localStorage.setItem('activeTab', $(e.target).attr('href'));
      });

      var activeTab = localStorage.getItem('activeTab');
      if(activeTab){
          $('#lawEditorTab a[href="' + activeTab + '"]').tab('show');
      }
    });
  </script> 
  
  <ul class="nav nav-tabs" id="lawEditorTab" role="tablist">
    <li  class="nav-item">
      <a class="nav-link active" id="general-tab" data-toggle="tab" href="#general" role="tab" aria-controls="general" aria-selected="true">General</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" id="modifications-tab" data-toggle="tab" href="#modifications" role="tab" aria-controls="modifications" aria-selected="false">Modificaciones</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" id="articles-tab" data-toggle="tab" href="#articles" role="tab" aria-controls="articles" aria-selected="false">Artículos</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" id="index-tab" data-toggle="tab" href="#index" role="tab" aria-controls="index" aria-selected="false">Índice</a>
    </li>
  </ul>

  <div class="tab-content" id="myTabContent">

    <div class="tab-pane fade show active" id="general" role="tabpanel" aria-labelledby="general-tab">
      <%= render 'form', law: @law %>
      <%law_tag = LawTag.new %>
      <%= render partial:'edit_table', locals: {law_tag: law_tag, all: @all_materias, tag_type: "materia", table_title: "Materia"}%>
    </div>
    
    <div class="tab-pane fade" id="modifications" role="tabpanel" aria-labelledby="modifications-tab">
      <%law_modification = LawModification.new %>
      <%= render partial:'edit_table', locals: {law_tag: law_modification, all: @all_modifications, tag_type: "modificacion", table_title: "Modificación"}%>
    </div>

    <div class="tab-pane fade" id="articles" role="tabpanel" aria-labelledby="articles-tab">
      <p></p>
      <%article_number = @article_number.to_i + 1%>
        
      <form action="<%= edit_law_path %>" method="get">
        <div class="form-group">
          <input name="article_number" value="<%= @article_number %>" type="text" placeholder="Número de artículo">
          <button class="btn btn-outline-primary" type="submit" ><i class="fas fa-search"></i></button>
          <button class="btn btn-outline-secondary" style="margin-left:20px;"><i class="fas fa-arrow-left"></i></i></button>
          <button class="btn btn-outline-secondary" type="submit" value="<%= article_number%>" style="margin-left:20px;"><i class="fas fa-arrow-right"></i></i></button>
          <button class="btn btn-outline-secondary" type="button" style="margin-left:20px;" data-toggle="modal" data-target="#exampleModalCenter"><i class="fas fa-plus"></i></button>
        </div>
      </form>
      
      <% if @article %>
        <%= form_with(model: @article, local: true) do |form| %>
          <% if @article.errors.any? %>
            <div id="error_explanation">
              <h2><%= pluralize(@article.errors.count, "error") %> prohibited this article from being saved:</h2>
        
              <ul>
                <% @article.errors.full_messages.each do |message| %>
                  <li><%= message %></li>
                <% end %>
              </ul>
            </div>
          <% end %>
        
          <div class="form-group">
            <p>Articulo actual: <%= @article_number %></p>
          </div>
        
          <div class="form-group">
            <%= form.text_area :body, class: 'form-control', rows: '10' %>
          </div>
        
          <div class="actions d-inline p-2">
            <%= form.submit "Guardar cambios", class: 'btn btn-primary' %>
            &nbsp;&nbsp;
            <u> <%= link_to 'Eliminar Artículo', law_path, class: "d-inline p-2 text-danger"%> </u>
          </div>
        <% end %>
      <% end %>
    </div>

    <div class="tab-pane fade" id="index" role="tabpanel" aria-labelledby="index-tab">
      
    </div>

  </div>
  <p></p>
</div>
